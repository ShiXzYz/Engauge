{% extends 'polls/base.html' %}
{% block title %}Results{% endblock %}

{% block content %}
<h2 style="font-size:1.8rem;">üìä Results</h2>
<p style="font-size:1.1rem; margin-bottom:1rem;"><strong>{{ poll.question_text }}</strong></p>

{% if format == 'single_choice' %}
  <h3 style="margin-bottom:1rem;">Vote Counts</h3>

  <ul style="list-style:none; padding:0;">
    {% for c, n in paired %}
      <li style="
        background:white;
        margin-bottom:0.6rem;
        padding:0.8rem 1rem;
        border-radius:10px;
        box-shadow:0 3px 8px rgba(0,0,0,0.06);
      ">
        <strong>{{ c }}</strong> ‚Äî {{ n }} vote{{ n|pluralize }}
      </li>
    {% endfor %}
  </ul>

  <p style="margin-top:1rem; font-weight:600;">Total responses: {{ total }}</p>

{% elif format == 'speed_ranking' %}
  <h3 style="margin-bottom:1rem;">Ranking Results</h3>
  <p><strong>Total responses:</strong> {{ total }}</p>

  <table style="
    width:100%;
    border-collapse:separate;
    border-spacing:0 0.5rem;
    margin-top:1rem;
  ">
    <thead>
      <tr style="text-align:left; color:#4b5563;">
        <th>Choice</th>
        {% for i in num_choices|make_list %}
          <th style="text-align:center;">Rank {{ forloop.counter }}</th>
        {% endfor %}
        <th style="text-align:center;">Avg Rank</th>
      </tr>
    </thead>

    <tbody>
      {% for item in results_data %}
      <tr style="
        background:white;
        box-shadow:0 3px 10px rgba(0,0,0,0.06);
      ">
        <td style="padding:0.8rem;">{{ item.choice }}</td>

        {% for count in item.rank_counts %}
          <td style="padding:0.8rem; text-align:center;">{{ count }}</td>
        {% endfor %}

        <td style="padding:0.8rem; text-align:center; font-weight:bold;">
          {{ item.avg_rank }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="margin-top:1rem; color:#6b7280;">
    <em>Lower average rank is better.</em>
  </p>
{% endif %}

<div style="margin-top:1.5rem;">
  <a href="{% url 'polls:manage_polls' %}"
     style="text-decoration:none; color:#6366f1; font-weight:600;">
     ‚Üê Back to Manage Polls
  </a>
</div>
{% endblock %}
